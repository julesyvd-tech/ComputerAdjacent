<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Compost Adjacent</title>
<link rel="icon" href="data:image/svg+xml;utf8,
%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cpath d='M8 36c4-10 12-12 20-10s14 8 20 12 8 6 12 4' stroke='%23ff4fb3' stroke-width='4' stroke-linecap='round' fill='none'/%3E%3C/svg%3E">
<meta property="og:title" content="Compost Adjacent">
<meta property="og:description" content="Cosmic compost transmissions">
<meta property="og:image" content="data:image/svg+xml;utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cpath d='M8 36c4-10 12-12 20-10s14 8 20 12 8 6 12 4' stroke='%23ff4fb3' stroke-width='4' stroke-linecap='round' fill='none'/%3E%3C/svg%3E">
<style>
  html,body{margin:0;height:100%;background:#000;font-family:Verdana,sans-serif;overflow:hidden;}
  body.inverted{filter:invert(1) hue-rotate(180deg);}
  canvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;}
  .title{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center;z-index:5;}
  .letter{font-size:clamp(28px,6vw,64px);font-weight:800;text-transform:uppercase;animation:wave 1.2s ease-in-out infinite;will-change:transform;color:var(--c);}
  @keyframes wave{0%,100%{transform:translateY(0)}25%{transform:translateY(-6px)}75%{transform:translateY(4px)}}
  #player{position:fixed;top:20px;left:20px;width:240px;height:80px;border-radius:10px;overflow:hidden;box-shadow:0 0 20px #ff4fb3;cursor:move;z-index:10;}
</style>
</head>
<body>
<canvas id="bg"></canvas>

<div class="title" id="title"></div>

<div id="player">
  <iframe src="https://open.spotify.com/embed/artist/4JYHgAnjpihRXtvZ8Qssok?utm_source=generator&theme=0"
          width="100%" height="100%" frameborder="0"
          allow="autoplay; encrypted-media" loading="lazy"></iframe>
</div>

<script>
const palette=['#ff4fb3','#80ffb0','#ffd24a','#ff8a3d','#50f1ff','#ff5b5b'];
/* vertical title */
const title=document.getElementById('title');
"COMPOST ADJACENT".split('').forEach((ch,i)=>{
  const s=document.createElement('span');
  s.textContent=ch;
  s.className='letter';
  s.style.setProperty('--c',palette[i%palette.length]);
  s.style.animationDelay=(i*0.1)+'s';
  s.style.marginLeft=(Math.random()*20-10)+'px';
  title.appendChild(s);
});
/* invert every 100th visit */
let count=+localStorage.getItem('visits')||0;count++;localStorage.setItem('visits',count);
if(count%100===0)document.body.classList.add('inverted');

/* draggable player */
const p=document.getElementById('player');
let ox,oy,dx,dy,drag=false;
p.addEventListener('mousedown',e=>{drag=true;ox=e.clientX;oy=e.clientY;dx=p.offsetLeft;dy=p.offsetTop;});
window.addEventListener('mouseup',()=>drag=false);
window.addEventListener('mousemove',e=>{
 if(!drag)return;
 let nx=dx+e.clientX-ox, ny=dy+e.clientY-oy;
 nx=Math.max(0,Math.min(window.innerWidth-p.offsetWidth,nx));
 ny=Math.max(0,Math.min(window.innerHeight-p.offsetHeight,ny));
 p.style.left=nx+'px';p.style.top=ny+'px';
});

/* starfield + worms + shooting stars */
const c=document.getElementById('bg');const ctx=c.getContext('2d');
function resize(){c.width=innerWidth;c.height=innerHeight;}
window.addEventListener('resize',resize);resize();
let worms=[],stars=[],shoots=[],boom=[],shootCount=0,tLast=0;
function initField(){
  worms=[];stars=[];
  for(let i=0;i<80;i++)worms.push({x:Math.random()*c.width,y:Math.random()*c.height,c:palette[i%palette.length],p:Math.random()*6});
  for(let i=0;i<400;i++)stars.push({x:Math.random()*c.width,y:Math.random()*c.height,c:palette[i%palette.length],f:Math.random()*Math.PI*2});
}
initField();
/* shooting star spawner */
function addShoot(){
  const side=Math.floor(Math.random()*4);
  let x,y,vx,vy;
  const speed=2+Math.random()*3;
  if(side===0){x=-50;y=Math.random()*c.height;vx=speed;vy=(Math.random()-0.5)*speed;}
  else if(side===1){x=c.width+50;y=Math.random()*c.height;vx=-speed;vy=(Math.random()-0.5)*speed;}
  else if(side===2){y=-50;x=Math.random()*c.width;vy=speed;vx=(Math.random()-0.5)*speed;}
  else{y=c.height+50;x=Math.random()*c.width;vy=-speed;vx=(Math.random()-0.5)*speed;}
  const color=palette[Math.floor(Math.random()*palette.length)];
  shoots.push({x,y,vx,vy,color,life:0});
  shootCount++;
  if(shootCount%5===0)createExplosion();
}
function createExplosion(){
  const cx=c.width/2+(Math.random()-0.5)*c.width*0.3;
  const cy=c.height/2+(Math.random()-0.5)*c.height*0.3;
  for(let i=0;i<40;i++){
    const ang=Math.random()*Math.PI*2;
    const sp=1+Math.random()*3;
    boom.push({x:cx,y:cy,vx:Math.cos(ang)*sp,vy:Math.sin(ang)*sp,color:palette[i%palette.length],life:0});
  }
}
/* visibility pause */
let active=true;
document.addEventListener('visibilitychange',()=>{active=!document.hidden;});
/* animation loop */
function frame(t){
  if(!active){requestAnimationFrame(frame);return;}
  const dt=(t-tLast)/16; tLast=t;
  ctx.fillStyle='rgba(0,0,0,0.2)';ctx.fillRect(0,0,c.width,c.height);
  // stars
  for(const s of stars){
    const b=(Math.sin(t/600+s.f)*0.5+0.5)*255|0;
    ctx.fillStyle=s.c;ctx.globalAlpha=0.6+0.4*Math.sin(t/800+s.f);
    ctx.fillRect(s.x|0,s.y|0,1,1);
  }
  ctx.globalAlpha=1;
  // worms
  for(const w of worms){
    w.p+=0.02;ctx.strokeStyle=w.c;ctx.lineWidth=1.4;
    ctx.beginPath();
    for(let i=0;i<10;i++){
      const xx=w.x+i*2+Math.sin(w.p+i*0.4)*2;
      const yy=w.y+Math.cos(w.p+i*0.6)*2;
      if(i===0)ctx.moveTo(xx,yy);else ctx.lineTo(xx,yy);
    }
    ctx.stroke();
  }
  // shooting stars
  for(let i=shoots.length-1;i>=0;i--){
    const s=shoots[i];s.x+=s.vx*dt;s.y+=s.vy*dt;s.life+=dt;
    ctx.strokeStyle=s.color;ctx.lineWidth=2;ctx.globalAlpha=Math.max(0,1-s.life/50);
    ctx.beginPath();ctx.moveTo(s.x,s.y);ctx.lineTo(s.x-s.vx*10,s.y-s.vy*10);ctx.stroke();ctx.globalAlpha=1;
    if(s.x<-60||s.x>c.width+60||s.y<-60||s.y>c.height+60||s.life>60)shoots.splice(i,1);
  }
  // explosions
  for(let i=boom.length-1;i>=0;i--){
    const b=boom[i];b.x+=b.vx*dt;b.y+=b.vy*dt;b.life+=dt;
    ctx.fillStyle=b.color;ctx.globalAlpha=Math.max(0,1-b.life/60);
    ctx.beginPath();ctx.arc(b.x,b.y,2,0,Math.PI*2);ctx.fill();ctx.globalAlpha=1;
    if(b.life>60)boom.splice(i,1);
  }
  requestAnimationFrame(frame);
}
requestAnimationFrame(frame);
/* schedule shooting stars */
setInterval(()=>{if(active)addShoot();},90000);
</script>
</body>
</html>
